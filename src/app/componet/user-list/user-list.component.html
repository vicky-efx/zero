<div class="page-container">
  <div class="header">
    <img src="zerochat_logo.png" />
    <div class="profile" (click)="goToProfile()">
      <img *ngIf="user?.image; else defaultAvatar" [src]="user.image" alt="Profile" />
      <ng-template #defaultAvatar>
        <img src="https://i.pravatar.cc/40" alt="Profile" />
      </ng-template>
    </div>
  </div>

  <div *ngIf="otherUsers.length > 0; else noUsers">
    <div *ngFor="let u of otherUsers" class="chat-item" (click)="openChat(u.id)">

      <!-- LEFT: Avatar + Name + Status -->
      <div class="chat-left">
        <div class="chat-avatar">
          <img [src]="u.image ? u.image : 'https://i.pravatar.cc/40?u=' + u.id" alt="Avatar"
            (click)="openUserModal(u, $event)" />
          <span *ngIf="u.status === 'online'" class="status-dot"></span>
        </div>
        <div class="chat-info">
          <div class="chat-name">{{ u.name }}</div>
          <div class="chat-status-text">
            {{ u.status === 'online' ? 'Online' : u.statusText }}
          </div>
        </div>
      </div>

      <!-- CENTER: Last message + Unread count -->
      <div class="chat-center">
        <div class="last-message">{{ u.lastMessage || 'No messages yet' }}</div>
      </div>

      <!-- RIGHT: Time + Unread Count -->
      <div class="chat-right">
        <div class="chat-time">{{ u.lastTime }}</div>
        <div *ngIf="u.unreadCount > 0" class="unread-badge">
          {{ u.unreadCount }}
        </div>
      </div>


    </div>
  </div>

  <ng-template #noUsers>
    <p>No users found.</p>
  </ng-template>

  <!-- Modal -->
  <div class="modal-overlay" *ngIf="showProfileModal" (click)="closeProfileModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <img [src]="selectedUserImage" alt="User Profile" />
    </div>
  </div>
</div>